# 无本地浏览器岗位数据方案（已落地）

更新时间：2026-02-11

## 已实现
- 云端 `JOB_DATA_PROVIDER=cloud` 时：
  - 先读 `cloud_jobs_cache`
  - 缓存为空时，自动回退到无浏览器搜索 provider（baidu/bing/brave/jooble）
- 已移除演示岗位兜底：
  - seed/demo 岗位会被过滤
  - 无真实数据时只返回明确 warning，不显示假岗位
- 增加数据质量控制：
  - 必须有可跳转链接（http/https）
  - 去重（link/id/title+company）
- 增加爬虫状态字段：
  - `last_push_at` / `last_received` / `last_new`

## 当前线上状态
- `/api/health` 已包含 `no_browser_fallback_enabled=true`
- 若 cloud 缓存为空，会自动尝试无浏览器 provider
- 目前失败主因：Baidu 触发验证码风控

## 你要做的最小配置（不需要 OpenClaw）
推荐顺序：
1. 配 `BRAVE_SEARCH_API_KEY`（首选）
2. 或配 `JOOBLE_API_KEY`
3. 可选再配 `JOB_SEARCH_SITES=zhipin.com,liepin.com,zhaopin.com,51job.com`

Railway 设置示例：
- `BRAVE_SEARCH_API_KEY=...`
- `JOB_DATA_PROVIDER=cloud`
- `JOB_SEARCH_SITES=zhipin.com,liepin.com,zhaopin.com,51job.com`

## 验证
1. `GET /api/health`
2. `GET /api/jobs/search?keywords=Python&location=北京&limit=5`
3. 预期：
   - `provider_mode` 为 `brave`/`jooble`/`cloud`
   - `jobs` 非空，且每条有 `link`

## 下一步优化（可继续并行）
- 前端增加“数据源状态卡片”：显示当前 provider、缓存条数、最近推送时间
- 推荐岗位增加“来源标签”
- 新增自动定时任务：每 30 分钟调用一次 `/api/jobs/search` 并写入缓存，减少首屏空结果
