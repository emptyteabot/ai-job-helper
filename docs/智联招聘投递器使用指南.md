# 智联招聘自动投递器使用指南

## 🚀 快速开始

### 1. 安装依赖

```bash
# 安装 DrissionPage（核心依赖）
pip install DrissionPage>=4.0.0

# 安装其他依赖
pip install -r requirements.txt
```

### 2. 运行测试

**方式一：使用批处理脚本（推荐）**
```bash
启动智联投递.bat
```

**方式二：直接运行 Python**
```bash
python test_zhilian.py
```

## 📖 功能说明

### 核心功能

1. **账号登录**
   - 支持手机号/邮箱登录
   - 自动保存 Cookie（7天有效）
   - 下次登录自动使用缓存

2. **职位搜索**
   - 关键词搜索
   - 地点筛选
   - 薪资范围筛选
   - 工作经验筛选
   - 学历要求筛选

3. **智能投递**
   - 一键批量投递
   - 黑名单过滤（公司/关键词）
   - 薪资范围过滤
   - 自动选择简历
   - 投递记录保存

4. **简历管理**
   - 上传简历（PDF/DOC/DOCX）
   - 自动选择默认简历

## 🔧 配置说明

### 基础配置

```python
config = {
    # 黑名单公司（不投递）
    'blacklist_companies': ['外包', '劳务派遣', '某某公司'],

    # 黑名单关键词（职位标题包含则不投递）
    'blacklist_keywords': ['实习', '兼职', '外包'],

    # 薪资范围（单位：元/月）
    'min_salary': 8000,   # 最低薪资
    'max_salary': 30000,  # 最高薪资
}
```

### 搜索过滤条件

```python
filters = {
    'salary_range': '10001-15000',  # 薪资范围
    'work_experience': '1-3年',     # 工作经验
    'education': '本科',            # 学历要求
    'company_type': '上市公司',     # 公司类型（可选）
}
```

## 💻 代码示例

### 基础使用

```python
from app.services.auto_apply.zhilian_applier import ZhilianApplier

# 创建投递器
config = {
    'blacklist_companies': ['外包'],
    'min_salary': 8000
}
applier = ZhilianApplier(config)

# 登录
applier.login('your_phone', 'your_password')

# 搜索职位
jobs = applier.search_jobs(
    keywords='Python开发',
    location='北京',
    filters={'salary_range': '10001-15000'}
)

# 批量投递
results = applier.batch_apply(jobs, max_count=10)

# 清理资源
applier.cleanup()
```

### 高级使用

```python
# 1. 使用缓存登录
applier = ZhilianApplier(config)
if applier.session_manager.is_session_valid('your_phone'):
    print("使用缓存登录")
    applier.login('your_phone', 'your_password')
else:
    print("需要重新登录")
    applier.login('your_phone', 'your_password')

# 2. 多条件搜索
jobs = applier.search_jobs(
    keywords='Python后端开发',
    location='北京',
    filters={
        'salary_range': '15001-25000',
        'work_experience': '3-5年',
        'education': '本科',
    }
)

# 3. 自定义投递逻辑
for job in jobs:
    # 自定义过滤条件
    if '加班' in job['title']:
        continue

    # 投递单个职位
    result = applier.apply_job(job)
    if result['success']:
        print(f"✓ 投递成功: {job['title']}")
    else:
        print(f"✗ 投递失败: {result['message']}")

    # 控制投递速度
    time.sleep(5)

# 4. 上传简历
applier.upload_resume('path/to/your/resume.pdf')
```

## 🎯 DrissionPage 优势

### 为什么选择 DrissionPage？

1. **速度快** - 比 Selenium 快 10 倍
2. **API 简洁** - 中文文档，易学易用
3. **反爬虫强** - 内置反检测功能
4. **稳定性高** - 国产开源，持续维护

### DrissionPage 核心用法

```python
from DrissionPage import ChromiumPage

# 创建页面
page = ChromiumPage()

# 访问网页
page.get('https://www.zhaopin.com')

# 元素定位（超简单）
page.ele('#id')              # ID
page.ele('.class')           # Class
page.ele('text:关键词')       # 文本
page.ele('@@attribute=value') # 属性

# 元素操作
element = page.ele('.search-input')
element.input('Python开发')  # 输入
element.click()              # 点击
text = element.text          # 获取文本

# 等待元素
page.wait.ele_displayed('.job-list')  # 等待显示
page.wait.url_change()                # 等待URL变化
```

## ⚠️ 注意事项

### 1. 登录相关

- 首次登录可能需要手动处理验证码
- Cookie 有效期为 7 天
- 建议使用小号测试

### 2. 投递频率

- 建议每次投递间隔 3-5 秒
- 每天投递不超过 50 个
- 避免被平台限制

### 3. 黑名单设置

```python
# 推荐的黑名单配置
config = {
    'blacklist_companies': [
        '外包', '劳务派遣', '人力资源',
        '猎头', '中介', '培训'
    ],
    'blacklist_keywords': [
        '实习', '兼职', '外包', '派遣',
        '销售', '客服', '电话'
    ]
}
```

### 4. 错误处理

- 登录失败：检查账号密码
- 搜索失败：检查网络连接
- 投递失败：可能已投递或职位关闭
- 验证码：需要手动处理

## 📊 性能指标

- **登录成功率**: >= 95%
- **搜索准确率**: >= 99%
- **投递成功率**: >= 90%
- **单次投递速度**: < 10秒

## 🔍 常见问题

### Q1: DrissionPage 安装失败？

```bash
# 方案1：使用国内镜像
pip install -i https://pypi.tuna.tsinghua.edu.cn/simple DrissionPage

# 方案2：升级 pip
python -m pip install --upgrade pip
pip install DrissionPage
```

### Q2: 浏览器驱动下载失败？

DrissionPage 会自动下载 Chrome 驱动，如果失败：
1. 检查网络连接
2. 使用代理
3. 手动下载驱动

### Q3: 登录时出现验证码？

- 首次登录可能需要验证码
- 脚本会等待 30 秒供手动处理
- 完成验证后会自动继续

### Q4: 投递失败率高？

可能原因：
1. 职位已关闭
2. 已投递过
3. 不符合要求
4. 网络问题

### Q5: 如何提高投递成功率？

1. 完善简历信息
2. 设置合理的筛选条件
3. 避免投递不匹配的职位
4. 控制投递频率

## 📝 日志说明

日志文件：`zhilian_test.log`

```
2026-02-17 19:00:00 - INFO - 正在初始化 DrissionPage...
2026-02-17 19:00:01 - INFO - DrissionPage 初始化成功
2026-02-17 19:00:02 - INFO - 正在打开登录页...
2026-02-17 19:00:05 - INFO - ✓ 登录成功
2026-02-17 19:00:10 - INFO - 正在搜索职位: Python开发 - 北京
2026-02-17 19:00:12 - INFO - ✓ 搜索完成，找到 20 个符合条件的职位
2026-02-17 19:00:15 - INFO - ✓ 投递成功: Python后端开发工程师
```

## 🚀 进阶功能

### 1. 集成到 Web 应用

```python
# 在 web_app.py 中添加智联招聘路由
from app.services.auto_apply.zhilian_applier import ZhilianApplier

@app.post("/api/zhilian/login")
async def zhilian_login(username: str, password: str):
    applier = ZhilianApplier(config)
    success = applier.login(username, password)
    return {"success": success}

@app.post("/api/zhilian/search")
async def zhilian_search(keywords: str, location: str):
    applier = ZhilianApplier(config)
    jobs = applier.search_jobs(keywords, location, {})
    return {"jobs": jobs}
```

### 2. 定时任务

```python
import schedule
import time

def auto_apply_job():
    applier = ZhilianApplier(config)
    applier.login('username', 'password')
    jobs = applier.search_jobs('Python开发', '北京', {})
    applier.batch_apply(jobs, max_count=10)
    applier.cleanup()

# 每天早上 9 点执行
schedule.every().day.at("09:00").do(auto_apply_job)

while True:
    schedule.run_pending()
    time.sleep(60)
```

## 📞 技术支持

- GitHub Issues: [提交问题](https://github.com/your-repo/issues)
- DrissionPage 文档: [官方文档](https://drissionpage.cn)

## 📄 许可证

MIT License
